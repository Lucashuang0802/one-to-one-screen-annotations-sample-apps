var AnnotationAccPack=function(){var e,n=function(n){this.options=n,this.widget=this.options.widget,this.elements={canvasContainer:this.options.comms_elements.callFeedWrap},e=this},t=[{id:"OT_pen",title:"Pen",icon:"../images/annotation/freehand.png",selectedIcon:"../images/annotation/freehand_selected.png"},{id:"OT_line",title:"Line",icon:"../images/annotation/line.png",selectedIcon:"../images/annotation/line_selected.png"},{id:"OT_shapes",title:"Shapes",icon:"../images/annotation/shapes.png",items:[{id:"OT_arrow",title:"Arrow",icon:"../images/annotation/arrow.png"},{id:"OT_rect",title:"Rectangle",icon:"../images/annotation/rectangle.png"},{id:"OT_oval",title:"Oval",icon:"../images/annotation/oval.png"},{id:"OT_star",title:"Star",icon:"../images/annotation/star.png",points:[[.5+.5*Math.cos(90*(Math.PI/180)),.5+.5*Math.sin(90*(Math.PI/180))],[.5+.25*Math.cos(126*(Math.PI/180)),.5+.25*Math.sin(126*(Math.PI/180))],[.5+.5*Math.cos(162*(Math.PI/180)),.5+.5*Math.sin(162*(Math.PI/180))],[.5+.25*Math.cos(198*(Math.PI/180)),.5+.25*Math.sin(198*(Math.PI/180))],[.5+.5*Math.cos(234*(Math.PI/180)),.5+.5*Math.sin(234*(Math.PI/180))],[.5+.25*Math.cos(270*(Math.PI/180)),.5+.25*Math.sin(270*(Math.PI/180))],[.5+.5*Math.cos(306*(Math.PI/180)),.5+.5*Math.sin(306*(Math.PI/180))],[.5+.25*Math.cos(342*(Math.PI/180)),.5+.25*Math.sin(342*(Math.PI/180))],[.5+.5*Math.cos(18*(Math.PI/180)),.5+.5*Math.sin(18*(Math.PI/180))],[.5+.25*Math.cos(54*(Math.PI/180)),.5+.25*Math.sin(54*(Math.PI/180))],[.5+.5*Math.cos(90*(Math.PI/180)),.5+.5*Math.sin(90*(Math.PI/180))]]}]},{id:"OT_colors",title:"Colors",icon:"",items:{}},{id:"OT_line_width",title:"Line Width",icon:"../images/annotation/line_width.png",items:{}},{id:"OT_clear",title:"Clear",icon:"../images/annotation/clear.png"}],i=["#1abc9c","#2ecc71","#3498db","#9b59b6","#8e44ad","#f1c40f","#e67e22","#e74c3c","#ded5d5"],a=10/6,o=function(){$(e.elements.resizeSubject).on("resize",m)},s=function(e,n,a){var o=_.property("toolbarId")(n)||"toolbar",s=_.property("toolbarItems")(n)||t,r=_.property("colors")(n)||i,c=function(){var e=a?a:window;return e.document.getElementById(o)};toolbar=new OTSolution.Annotations.Toolbar({session:e,container:c(),colors:r,items:s,externalWindow:a||null})},r=_.throttle(function(){e.canvas.onResize()},1e3),c=function(){var e=$.Deferred(),n=.8*screen.width|0,t=n/a,i=["templates/screenshare.html?opentok-annotation"].join(""),o=["toolbar=no","location=no","directories=no","status=no","menubar=no","scrollbars=no","resizable=no","copyhistory=no","width="+n,"height="+t,"left="+(screen.width/2-n/2),"top="+(screen.height/2-t/2)].join(","),s=window.open(i,"",o);s.toolbar=toolbar,s.OT=OT,s.$=$;var r=function(){s.createContainerElements?$(s.document).ready(function(){e.resolve(s)}):setTimeout(r,100)};return r(),e.promise()},l=function(){$(e.elements.resizeSubject).off("resize",m),toolbar.remove()},d=function(n,t){var i=$.Deferred();return _.property("externalWindow")(t)?c().then(function(a){e.widget.comms_elements.annotationWindow=a,s(n,t,a),toolbar.createPanel(a),i.resolve()}):(s(n,t),i.resolve()),i.promise()},h=function(n,t,i){e.elements.resizeSubject=i||e.elements.canvasContainer,e.elements.externalWindow=i,e.elements.annotationContainer=t,e.canvas=new OTSolution.Annotations({feed:n,container:t});var a=e.elements.externalWindow?e.elements.externalWindow:window;e.elements.canvas=$(_.first(a.document.getElementsByTagName("canvas"))),toolbar.addCanvas(e.canvas),e.canvas.onScreenCapture(function(e){var n=window.open(e,"_blank");n.focus()}),o(),m()},m=function(){var n,t;if(e.elements.externalWindow){var i={width:e.elements.externalWindow.innerWidth,height:e.elements.externalWindow.innerHeight},o=i.width/a;o<=i.height?(n=i.width,t=o):(t=i.height,n=t*a)}else n=$(e.elements.canvasContainer).width(),t=$(e.elements.canvasContainer).height();$(e.elements.annotationContainer).css({width:n,height:t}),$(e.elements.canvas).css({width:n,height:t}),$(e.elements.canvas).attr({width:n,height:t}),r()},u=function(){l(),delete e.canavs,delete e.elements,e.elements.externalWindow&&(e.elements.externalWindow.close(),delete e.widget.comms_elements.annotationWindow)};return n.prototype={constructor:annotationComponent,start:d,linkCanvas:h,resizeCanvas:m,end:u},n}(),ScreenSharingAccPack=function(){var e,n;e=function(){var e,n=['<button class="wms-icon-screen" id="startScreenShareBtn"></button>'].join("\n"),t=['<div class="hidden" id="screenShareView">','<div class="wms-feed-main-video">','<div class="wms-feed-holder" id="videoHolderScreenShare"></div>','<div class="wms-feed-mask"></div>','<img src="/images/mask/video-mask.png"/>',"</div>",'<div class="wms-feed-call-controls" id="feedControlsFromScreen">','<button class="wms-icon-screen active hidden" id="endScreenShareBtn"></button>',"</div>","</div>"].join("\n"),i=['<div id="dialog-form-chrome" class="wms-modal" style="display: none;">','<div class="wms-modal-body">','<div class="wms-modal-title with-icon">','<i class="wms-icon-share-large"></i>',"<span>Screen Share<br/>Extension Installation</span>","</div>","<p>You need a Chrome extension to share your screen. Install Screensharing Extension. Once you have installed, please, click the share screen button again.</p>",'<button id="btn-install-plugin-chrome" class="wms-btn-install">Accept</button>','<button id="btn-cancel-plugin-chrome" class="wms-cancel-btn-install"></button>',"</div>","</div>",'<div id="dialog-form-ff" class="wms-modal" style="display: none;">','<div class="wms-modal-body">','<div class="wms-modal-title with-icon">','<i class="wms-icon-share-large"></i>',"<span>Screen Share<br/>Extension Installation</span>","</div>","<p>You need a Firefox extension to share your screen. Install Screensharing Extension. Once you have installed, refresh your browser and click the share screen button again.</p>",'<a href="#" id="btn-install-plugin-ff" class="wms-btn-install" href="">Install extension</a>','<a href="#" id="btn-cancel-plugin-ff" class="wms-cancel-btn-install"></a>',"</div>","</div>"].join("\n"),a=function(n){e=this,this._options=n||{},void 0!=n&&(this._session=n.session,this._extensionURL=n.extensionURL,this._extensionID=n.extensionID,this._extensionPathFF=n.extensionPathFF,this._startButtonID=n.comms_elements.shareScreenBtn,this._endButtonID=n.comms_elements.endShareScreenBtn,this._widget=n.widget,this._startScreenSharingBtnParent=n._startScreenSharingBtnParent||"#feedControls",this._screenSharingViewParent=n._screenSharingViewParent||"#videoWraper","Chrome"==OT.$.browser()&&OT.registerScreenSharingExtension("chrome",this._extensionID,2)),_setupTemplates(),o()},o=function(a){var o=e._startScreenSharingBtnParent||document.body,c=e._screenSharingViewParent||document.body;e._startButtonID=e._startButtonID||"#startScreenShareBtn",e._endButtonID=e._endButtonID||"#endScreenShareBtn",$("body").append(i),$(o).append(n),$(c).append(t);var l=document.querySelector(e._startButtonID),d=document.querySelector(e._endButtonID);l.onclick=s,d.onclick=r},s=function(){e._widget.start()},r=function(){e.widget.end()};return a.prototype={constructor:a,onStarted:function(){},onEnded:function(){},onError:function(e){console.log("OT: Screen sharing error: ",e)}},a}(),n=function(e){window.OTScreenSharingSolution=window.OTScreenSharingSolution||{},window.OTScreenSharingSolution.ScreenSharing={ScreenSharingUI:e}}(e)}();